"""
Scenario definitions - GENERATED FILE

This file is automatically generated from definitions/scenarios.json
DO NOT EDIT MANUALLY - changes will be overwritten

To modify scenarios, edit definitions/scenarios.json and run:
    python scripts/generate_python.py
"""

from dataclasses import dataclass
import numpy as np


@dataclass
class Scenario:
    """Represents the stochastic configuration of a game."""

    # Fire spread and extinguishing parameters
    beta: float  # Fire spread probability per neighbor
    kappa: float  # Extinguish efficiency

    # Reward parameters
    A: float  # Reward per saved house
    L: float  # Penalty per ruined house
    c: float  # Cost per worker per night

    # Initial conditions
    rho_ignite: float  # Initial fraction of houses burning
    N_min: int  # Minimum nights before termination
    p_spark: float  # Probability of spontaneous ignition
    N_spark: int  # Number of nights with sparks active

    # Game setup
    num_agents: int  # Number of agents participating

    def to_feature_vector(self) -> np.ndarray:
        """
        Convert scenario parameters to a feature vector for agent conditioning.
        Returns a numpy array with scenario features.
        """
        return np.array(
            [
                self.beta,
                self.kappa,
                self.A,
                self.L,
                self.c,
                self.rho_ignite,
                self.N_min,
                self.p_spark,
                self.N_spark,
                self.num_agents,
            ],
            dtype=np.float32,
        )


def default_scenario(num_agents: int) -> Scenario:
    """Standard balanced scenario for general testing"""
    return Scenario(
        beta=0.25,
        kappa=0.5,
        A=100.0,
        L=100.0,
        c=0.5,
        rho_ignite=0.2,
        N_min=12,
        p_spark=0.02,
        N_spark=12,
        num_agents=num_agents,
    )


def easy_scenario(num_agents: int) -> Scenario:
    """Low difficulty with favorable conditions - low fire spread, high extinguish rate"""
    return Scenario(
        beta=0.1,
        kappa=0.8,
        A=100.0,
        L=100.0,
        c=0.5,
        rho_ignite=0.1,
        N_min=10,
        p_spark=0.01,
        N_spark=10,
        num_agents=num_agents,
    )


def hard_scenario(num_agents: int) -> Scenario:
    """High difficulty with challenging conditions - high fire spread, low extinguish rate"""
    return Scenario(
        beta=0.4,
        kappa=0.3,
        A=100.0,
        L=100.0,
        c=0.5,
        rho_ignite=0.3,
        N_min=15,
        p_spark=0.05,
        N_spark=15,
        num_agents=num_agents,
    )


def trivial_cooperation_scenario(num_agents: int) -> Scenario:
    """Easy fires reward universal cooperation"""
    return Scenario(
        beta=0.15,
        kappa=0.9,
        A=100.0,
        L=100.0,
        c=0.5,
        rho_ignite=0.1,
        N_min=12,
        p_spark=0.0,
        N_spark=12,
        num_agents=num_agents,
    )


def early_containment_scenario(num_agents: int) -> Scenario:
    """Fires start aggressive but can be stopped early"""
    return Scenario(
        beta=0.35,
        kappa=0.6,
        A=100.0,
        L=100.0,
        c=0.5,
        rho_ignite=0.3,
        N_min=12,
        p_spark=0.02,
        N_spark=12,
        num_agents=num_agents,
    )


def greedy_neighbor_scenario(num_agents: int) -> Scenario:
    """Social dilemma between self-interest and cooperation"""
    return Scenario(
        beta=0.15,
        kappa=0.4,
        A=100.0,
        L=100.0,
        c=1.0,
        rho_ignite=0.2,
        N_min=12,
        p_spark=0.02,
        N_spark=12,
        num_agents=num_agents,
    )


def sparse_heroics_scenario(num_agents: int) -> Scenario:
    """Few workers can make the difference"""
    return Scenario(
        beta=0.1,
        kappa=0.5,
        A=100.0,
        L=100.0,
        c=0.8,
        rho_ignite=0.15,
        N_min=20,
        p_spark=0.02,
        N_spark=20,
        num_agents=num_agents,
    )


def rest_trap_scenario(num_agents: int) -> Scenario:
    """Fires usually extinguish themselves, but not always"""
    return Scenario(
        beta=0.05,
        kappa=0.95,
        A=100.0,
        L=100.0,
        c=0.2,
        rho_ignite=0.1,
        N_min=12,
        p_spark=0.02,
        N_spark=12,
        num_agents=num_agents,
    )


def chain_reaction_scenario(num_agents: int) -> Scenario:
    """High spread demands distributed firefighting teams"""
    return Scenario(
        beta=0.45,
        kappa=0.6,
        A=100.0,
        L=100.0,
        c=0.7,
        rho_ignite=0.3,
        N_min=15,
        p_spark=0.03,
        N_spark=15,
        num_agents=num_agents,
    )


def deceptive_calm_scenario(num_agents: int) -> Scenario:
    """Honest signaling rewarded during occasional flare-ups"""
    return Scenario(
        beta=0.25,
        kappa=0.6,
        A=100.0,
        L=100.0,
        c=0.4,
        rho_ignite=0.1,
        N_min=20,
        p_spark=0.05,
        N_spark=20,
        num_agents=num_agents,
    )


def overcrowding_scenario(num_agents: int) -> Scenario:
    """Too many workers reduce efficiency"""
    return Scenario(
        beta=0.2,
        kappa=0.3,
        A=50.0,
        L=100.0,
        c=0.6,
        rho_ignite=0.1,
        N_min=12,
        p_spark=0.02,
        N_spark=12,
        num_agents=num_agents,
    )


def mixed_motivation_scenario(num_agents: int) -> Scenario:
    """House ownership creates conflicting incentives"""
    return Scenario(
        beta=0.3,
        kappa=0.5,
        A=100.0,
        L=100.0,
        c=0.6,
        rho_ignite=0.2,
        N_min=15,
        p_spark=0.03,
        N_spark=15,
        num_agents=num_agents,
    )



# Registry of all scenarios
SCENARIO_REGISTRY = {
    "default": default_scenario,
    "easy": easy_scenario,
    "hard": hard_scenario,
    "trivial_cooperation": trivial_cooperation_scenario,
    "early_containment": early_containment_scenario,
    "greedy_neighbor": greedy_neighbor_scenario,
    "sparse_heroics": sparse_heroics_scenario,
    "rest_trap": rest_trap_scenario,
    "chain_reaction": chain_reaction_scenario,
    "deceptive_calm": deceptive_calm_scenario,
    "overcrowding": overcrowding_scenario,
    "mixed_motivation": mixed_motivation_scenario,
}



def get_scenario_by_name(name: str, num_agents: int) -> Scenario:
    """
    Get a scenario by name.

    Args:
        name: Scenario name (e.g., "trivial_cooperation", "default")
        num_agents: Number of agents in the scenario

    Returns:
        Scenario object

    Raises:
        ValueError: If scenario name is invalid

    Example:
        >>> scenario = get_scenario_by_name("trivial_cooperation", num_agents=4)
    """
    if name not in SCENARIO_REGISTRY:
        valid_names = ", ".join(sorted(SCENARIO_REGISTRY.keys()))
        raise ValueError(f"Unknown scenario '{name}'. Valid options: {valid_names}")

    return SCENARIO_REGISTRY[name](num_agents)


def list_scenarios() -> list:
    """
    Get list of available scenario names.

    Returns:
        Sorted list of scenario names

    Example:
        >>> scenarios = list_scenarios()
        >>> print(scenarios)
        ['chain_reaction', 'deceptive_calm', 'default', ...]
    """
    return sorted(SCENARIO_REGISTRY.keys())
